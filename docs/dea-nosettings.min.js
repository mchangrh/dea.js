const VERSION="1.0.0",replace=()=>[...document.querySelectorAll("ytd-compact-video-renderer,ytd-rich-item-renderer:not(.dea-js)")].slice(0,50).forEach(replaceElem),basicFormatter=(e,t=!1)=>t?e.replace(/>/g,""):e.normalize(normalization),replaceElem=async e=>{var t,r,a,n;e.classList.contains("dea-js")||(a=e?.polymerController?.__data?.data?.videoId??e?.polymerController?.__data?.data?.content?.videoRenderer?.videoId)&&({title:t,has_thumb:n}=await getDeaVideo(a),a=thumbEndpoint+"/api/v1/getThumbnail?videoID="+a,(r=e.querySelector("yt-image img")).src?r.src=a:r.lazyData.sources=[{url:a,width:720,height:404}],n||(r.style.filter=imgfilter),a=e.querySelector("#video-title"),n=basicFormatter(t?"ðŸ§¿"+t:a.innerText,!!t),a.innerText=n,t||(a.style.textTransform=transform),r)&&a&&e.classList.add("dea-js")},getDeaVideo=async e=>fetch(serverEndpoint+"/api/branding?videoID="+e).then(e=>e.json()).then(e=>({title:e.titles?.[0]?.title,has_thumb:Boolean(e.thumbnails.length)}));function setup(){if(console.log(`@mchangrh/DEA.js ${VERSION} Loaded`),console.log("Uses SponsorBlock data licensed used under CC BY-NC-SA 4.0 from https://sponsor.ajay.app/"),document.querySelector(".cbTitleButtonContainer"))return console.log("[DEA.js] Extension Present, Exiting");replace(),document.addEventListener("yt-navigate-finish",replace),window.addEventListener("scroll",replace)}